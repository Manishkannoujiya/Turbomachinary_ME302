% Compressor Operation Map
mdot_ref = [10.55028375, 10.54743366, 10.5265642, 10.54056709, 10.53225492, ...
            10.52059919, 10.51250485, 10.50355709, 10.49797497, 10.51550705, ...
            10.5020042, 10.49191763, 10.47588418, 10.48375557, 10.47836222, ...
            10.47843951, 10.46355384, 10.45631264, 10.44488778, 10.4581924, ...
            10.45107807, 10.42238805, 10.44162267, 10.43130054, 10.41036495, ...
            10.41905258, 10.43188241, 10.42140115, 10.41561707, 10.40954302, ...
            10.41479564, 10.40199814, 10.39376047, 10.38489335, 10.37631332, ...
            10.38621781, 10.3856431, 10.37966179, 10.3795998, 10.36727402, ...
            10.35801514, 10.36003768, 10.36234453, 10.34463492, 10.34081779, ...
            10.33777757, 10.32242223, 10.30721935, 10.30057968, 10.29763034, ...
            10.29088943, 10.28937082, 10.28094733, 10.28656233, 10.26804526, ...
            10.26534365, 10.25545969, 10.26546034, 10.24861681, 10.23843373, ...
            10.24156118, 10.2439604, 10.22443436, 10.21289479, 10.21858794, ...
            10.1995637, 10.18042293, 10.17837449, 10.17359894, 10.16195516, ...
            10.1579187, 10.13634191, 10.1392643, 10.15589092, 10.14100601, ...
            10.11729257, 10.10949919, 10.10855669, 10.10723309, 10.09719444, ...
            10.09713307, 10.07663076, 10.07281606, 10.07444751, 10.05856203, ...
            10.04926102, 10.02400929, 10.03068154, 10.03775193, 9.997488823, ...
            9.986864652, 9.988169639, 9.974162477, 9.942390092, 9.947825875, ...
            9.91905215, 9.890516002, 9.884940031, 9.856511291, 9.869430473, ...
            9.84480217, 9.829892571, 9.809052116, 9.791287644, 9.779826995, ...
            9.755803003, 9.751295115, 9.738988889, 9.709396421, 9.681966217, ...
            9.674874285, 9.656636461, 9.634181128, 9.61882918, 9.608418947, ...
            9.574656125, 9.543653225, 9.545461855, 9.526905075, 9.492349414, ...
            9.476704877, 9.468499817, 9.438085904, 9.410395443, 9.374503718, ...
            9.383322237, 9.35478089, 9.32391436, 9.275782871, 9.259602943, ...
            9.213002018, 9.166633804, 9.144796745, 9.117519014, 9.080686437, ...
            9.038655467, 9.005166855, 8.975223927];

P0_ratio = [1.210453952, 1.210681035, 1.21072001, 1.210876663, 1.212341445, ...
            1.212024862, 1.212637371, 1.212775584, 1.213608952, 1.213124031, ...
            1.21371333, 1.215095944, 1.214521887, 1.214323669, 1.215370932, ...
            1.215273449, 1.215438604, 1.216327636, 1.217111619, 1.216397739, ...
            1.216061295, 1.21725439, 1.216750242, 1.21722572, 1.217441396, ...
            1.217772552, 1.217618515, 1.217548062, 1.217795828, 1.218672365, ...
            1.218892428, 1.218963086, 1.218982928, 1.219742594, 1.219809639, ...
            1.219734299, 1.219589556, 1.220560697, 1.220589943, 1.220545569, ...
            1.2208532, 1.221309942, 1.222045786, 1.221899411, 1.222466889, ...
            1.223218656, 1.2232485, 1.223519391, 1.223854017, 1.225244942, ...
            1.224870305, 1.224431367, 1.225223994, 1.225774075, 1.226231838, ...
            1.226294444, 1.226293459, 1.226722245, 1.227343899, 1.226799022, ...
            1.227771443, 1.228398835, 1.227964669, 1.228105916, 1.22844747, ...
            1.22921517, 1.230155775, 1.229685804, 1.230414687, 1.230722546, ...
            1.231194705, 1.232029008, 1.232302894, 1.231940554, 1.232345038, ...
            1.233079158, 1.233033902, 1.233279479, 1.233425974, 1.234413852, ...
            1.234700484, 1.235268302, 1.235723322, 1.235612513, 1.235908234, ...
            1.236624949, 1.237380483, 1.23704784, 1.238095793, 1.238566539, ...
            1.239120141, 1.240304153, 1.239680714, 1.24058771, 1.241213252, ...
            1.242420592, 1.243146436, 1.243721271, 1.244579902, 1.245143399, ...
            1.24560239, 1.246736544, 1.247662508, 1.248638025, 1.248395826, ...
            1.24961661, 1.249696444, 1.250497803, 1.250876118, 1.251921626, ...
            1.253064724, 1.253220016, 1.254016221, 1.254718376, 1.25560333, ...
            1.256443952, 1.256423085, 1.256957286, 1.258442704, 1.260175879, ...
            1.259922081, 1.260785346, 1.2616592, 1.262135987, 1.262933291, ...
            1.263832466, 1.264258821, 1.265471673, 1.266464155, 1.266693581, ...
            1.268200167, 1.269157695, 1.269156549, 1.271191251, 1.271223198, ...
            1.272217903, 1.273317281, 1.273895308];

figure;
plot(mdot_ref, P0_ratio, 'b-', 'LineWidth', 2);
hold on;
plot(8.975, 1.0826, 'ro', 'MarkerSize', 10, 'MarkerFaceColor', 'r');
yline(1.0687, 'g--', 'LineWidth', 1.5, 'Label', 'Minimum P0 ratio (1.0687)');
yline(250/230.92, 'r:', 'LineWidth', 1.5, 'Label', 'Max Pressure Constraint');

title('Compressor Operation Map', 'FontSize', 14);
xlabel('Mass Flow Rate (kg/s)', 'FontSize', 12);
ylabel('Pressure Ratio (P0 ratio)', 'FontSize', 12);
grid on;
legend('Compressor Curve', 'Operating Point (s=0.593)', 'Location', 'best');
set(gca, 'FontSize', 11);
hold off;

% Save the figure
print('compressor_map', '-dpng', '-r300');